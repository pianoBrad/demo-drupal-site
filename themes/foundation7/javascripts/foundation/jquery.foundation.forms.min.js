/*
 * jQuery Custom Forms Plugin 1.0
 * www.ZURB.com
 * Copyright 2010, ZURB
 * Free to use under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
*/(function(e){var t=function(){return{tmp:[],hidden:null,adjust:function(t){var n=this;n.hidden=t.parents().andSelf().filter(":hidden");n.hidden.each(function(){var t=e(this);n.tmp.push(t.attr("style"));t.css({visibility:"hidden",display:"block"})})},reset:function(){var t=this;t.hidden.each(function(n){var r=e(this),i=t.tmp[n];i===undefined?r.removeAttr("style"):r.attr("style",i)});t.tmp=[];t.hidden=null}}};jQuery.foundation=jQuery.foundation||{};jQuery.foundation.customForms=jQuery.foundation.customForms||{};e.foundation.customForms.appendCustomMarkup=function(n){function i(t,n){var r=e(n).hide(),i=r.attr("type"),s=r.next("span.custom."+i);s.length===0&&(s=e('<span class="custom '+i+'"></span>').insertAfter(r));s.toggleClass("checked",r.is(":checked"));s.toggleClass("disabled",r.is(":disabled"))}function s(r,i){var s=t(),o=e(i),u=o.next("div.custom.dropdown"),a=u.find("ul"),f=u.find(".current"),l=u.find(".selector"),c=o.find("option"),h=c.filter(":selected"),p=0,d="",v,m=!1;if(o.hasClass(n.disable_class))return;if(u.length===0){var g=o.hasClass("small")?"small":o.hasClass("medium")?"medium":o.hasClass("large")?"large":o.hasClass("expand")?"expand":"";u=e('<div class="'+["custom","dropdown",g].join(" ")+'"><a href="#" class="selector"></a><ul /></div>');l=u.find(".selector");a=u.find("ul");d=c.map(function(){return"<li>"+e(this).html()+"</li>"}).get().join("");a.append(d);m=u.prepend('<a href="#" class="current">'+h.html()+"</a>").find(".current");o.after(u).hide()}else{d=c.map(function(){return"<li>"+e(this).html()+"</li>"}).get().join("");a.html("").append(d)}u.toggleClass("disabled",o.is(":disabled"));v=a.find("li");c.each(function(t){if(this.selected){v.eq(t).addClass("selected");m&&m.html(e(this).html())}});a.css("width","auto");u.css("width","auto");if(!u.is(".small, .medium, .large, .expand")){u.addClass("open");s.adjust(a);p=v.outerWidth()>p?v.outerWidth():p;s.reset();u.removeClass("open");u.width(p+18);a.width(p+16)}}var r={disable_class:"no-custom"};n=e.extend(r,n);e("form.custom input:radio[data-customforms!=disabled]").each(i);e("form.custom input:checkbox[data-customforms!=disabled]").each(i);e("form.custom select[data-customforms!=disabled]").each(s)};var n=function(t){var n=0,r=t.next();$options=t.find("option");r.find("ul").html("");$options.each(function(){$li=e("<li>"+e(this).html()+"</li>");r.find("ul").append($li)});$options.each(function(t){if(this.selected){r.find("li").eq(t).addClass("selected");r.find(".current").html(e(this).html())}});r.removeAttr("style").find("ul").removeAttr("style");r.find("li").each(function(){r.addClass("open");e(this).outerWidth()>n&&(n=e(this).outerWidth());r.removeClass("open")});r.css("width",n+18+"px");r.find("ul").css("width",n+16+"px")},r=function(e){var t=e.prev(),n=t[0];if(!1===t.is(":disabled")){n.checked=n.checked?!1:!0;e.toggleClass("checked");t.trigger("change")}},i=function(e){var t=e.prev(),n=t.closest("form.custom"),r=t[0];if(!1===t.is(":disabled")){n.find('input:radio[name="'+t.attr("name")+'"]').next().not(e).removeClass("checked");e.hasClass("checked")||e.toggleClass("checked");r.checked=e.hasClass("checked");t.trigger("change")}};e(document).on("click","form.custom span.custom.checkbox",function(t){t.preventDefault();t.stopPropagation();r(e(this))});e(document).on("click","form.custom span.custom.radio",function(t){t.preventDefault();t.stopPropagation();i(e(this))});e(document).on("change","form.custom select[data-customforms!=disabled]",function(t){n(e(this))});e(document).on("click","form.custom label",function(t){var n=e("#"+e(this).attr("for")+"[data-customforms!=disabled]"),s,o;if(n.length!==0)if(n.attr("type")==="checkbox"){t.preventDefault();s=e(this).find("span.custom.checkbox");s.length==0&&(s=e(this).next("span.custom.checkbox"));s.length==0&&(s=e(this).prev("span.custom.checkbox"));r(s)}else if(n.attr("type")==="radio"){t.preventDefault();o=e(this).find("span.custom.radio");o.length==0&&(o=e(this).next("span.custom.radio"));o.length==0&&(o=e(this).prev("span.custom.radio"));i(o)}});e(document).on("click","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(t){var n=e(this),r=n.closest("div.custom.dropdown"),i=r.prev();t.preventDefault();e("div.dropdown").removeClass("open");if(!1===i.is(":disabled")){r.toggleClass("open");r.hasClass("open")?e(document).bind("click.customdropdown",function(t){r.removeClass("open");e(document).unbind(".customdropdown")}):e(document).unbind(".customdropdown");return!1}});e(document).on("click","form.custom div.custom.dropdown li",function(t){var n=e(this),r=n.closest("div.custom.dropdown"),i=r.prev(),s=0;t.preventDefault();t.stopPropagation();e("div.dropdown").removeClass("open");n.closest("ul").find("li").removeClass("selected");n.addClass("selected");r.removeClass("open").find("a.current").html(n.html());n.closest("ul").find("li").each(function(e){n[0]==this&&(s=e)});i[0].selectedIndex=s;i.trigger("change")});e.fn.foundationCustomForms=e.foundation.customForms.appendCustomMarkup})(jQuery);